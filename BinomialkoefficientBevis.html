<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interaktivt Bevis for Binomialkoefficienten - Komplet Gennemgang</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .content {
            padding: 40px;
        }

        .step-container {
            margin-bottom: 50px;
            padding: 30px;
            border-radius: 15px;
            background: #f8f9fa;
            border-left: 8px solid #4facfe;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .step-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
        }

        .step-number {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            font-weight: bold;
            margin-right: 20px;
        }

        .step-title {
            font-size: 1.8em;
            color: #2c3e50;
            font-weight: bold;
        }

        .interactive-demo {
            background: white;
            padding: 30px;
            border-radius: 12px;
            margin: 25px 0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border: 2px solid #e0e0e0;
        }

        .demo-controls {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .control-group label {
            font-weight: bold;
            color: #2c3e50;
            font-size: 1.1em;
        }

        .control-group input {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 18px;
            width: 100px;
            text-align: center;
            font-weight: bold;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-primary {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .btn-success {
            background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
        }

        .btn-warning {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%);
        }

        .element-pool {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
            justify-content: center;
        }

        .element {
            background: #3498db;
            color: white;
            padding: 15px 20px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 1.2em;
            cursor: pointer;
            transition: all 0.3s;
            user-select: none;
            min-width: 50px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .element:hover {
            background: #2980b9;
            transform: scale(1.05);
        }

        .element.selected {
            background: #e74c3c;
            transform: scale(1.1);
        }

        .element.used {
            background: #95a5a6;
            cursor: not-allowed;
        }

        .element.highlighted {
            background: #f39c12;
            animation: pulse 1s infinite;
        }

        .arrangement-area {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
            border: 2px dashed #bdc3c7;
            min-height: 120px;
        }

        .arrangement {
            background: white;
            border: 2px solid #3498db;
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            display: flex;
            gap: 15px;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .arrangement-number {
            background: #3498db;
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-weight: bold;
            min-width: 40px;
            text-align: center;
            font-size: 1.1em;
        }

        .position {
            background: #ecf0f1;
            border: 2px solid #bdc3c7;
            padding: 10px 15px;
            border-radius: 8px;
            font-weight: bold;
            min-width: 60px;
            text-align: center;
        }

        .position.filled {
            background: #2ecc71;
            color: white;
            border-color: #27ae60;
        }

        .calculation-box {
            background: white;
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
            border: 3px solid #e74c3c;
            text-align: center;
        }

        .calculation-step {
            margin: 15px 0;
            padding: 15px;
            border-radius: 8px;
            background: #f8f9fa;
            border-left: 4px solid #3498db;
            font-size: 1.1em;
        }

        .highlight {
            background: #ffeb3b;
            padding: 3px 6px;
            border-radius: 4px;
            font-weight: bold;
        }

        .formula-display {
            background: #2c3e50;
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.3em;
        }

        .permutation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
            max-height: 400px;
            overflow-y: auto;
            border: 2px solid #ddd;
            border-radius: 10px;
            padding: 15px;
        }

        .permutation-item {
            background: white;
            border: 2px solid #ddd;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            transition: all 0.3s;
        }

        .permutation-item:hover {
            border-color: #3498db;
            transform: translateY(-2px);
        }

        .permutation-item.highlighted {
            border-color: #e74c3c;
            background: #ffe6e6;
        }

        .step-explanation {
            background: #e8f5e8;
            border: 2px solid #27ae60;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            font-size: 1.1em;
        }

        .interactive-exercise {
            background: #fff3cd;
            border: 2px solid #ffc107;
            padding: 25px;
            border-radius: 12px;
            margin: 25px 0;
        }

        .exercise-question {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #856404;
        }

        .answer-options {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .answer-option {
            background: white;
            border: 2px solid #ffc107;
            padding: 15px 25px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .answer-option:hover {
            background: #ffc107;
            color: white;
        }

        .answer-option.correct {
            background: #28a745;
            color: white;
            border-color: #28a745;
        }

        .answer-option.incorrect {
            background: #dc3545;
            color: white;
            border-color: #dc3545;
        }

        .feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            font-weight: bold;
            text-align: center;
        }

        .feedback.correct {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .feedback.incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .comparison-box {
            background: white;
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
            border: 3px solid #9b59b6;
            text-align: center;
        }

        .group-comparison {
            display: flex;
            gap: 30px;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .group-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #ddd;
            min-width: 200px;
        }

        .group-box.with-order {
            border-color: #3498db;
            background: #e3f2fd;
        }

        .group-box.without-order {
            border-color: #27ae60;
            background: #e8f5e8;
        }

        .group-title {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 15px;
        }

        .group-elements {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .group-element {
            background: #3498db;
            color: white;
            padding: 8px 12px;
            border-radius: 15px;
            font-weight: bold;
            font-size: 0.9em;
        }

        .group-element.without-order {
            background: #27ae60;
        }

        .arrow {
            font-size: 2em;
            color: #9b59b6;
            font-weight: bold;
        }

        .overcounting-demo {
            background: #ffe6e6;
            border: 3px solid #e74c3c;
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
        }

        .overcounting-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #c0392b;
            margin-bottom: 20px;
            text-align: center;
        }

        .overcounting-explanation {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #e74c3c;
        }

        .correction-demo {
            background: #e8f5e8;
            border: 3px solid #27ae60;
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
        }

        .correction-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #27ae60;
            margin-bottom: 20px;
            text-align: center;
        }

        .division-visual {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .division-box {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #3498db;
            text-align: center;
            min-width: 150px;
        }

        .division-symbol {
            font-size: 2em;
            color: #e74c3c;
            font-weight: bold;
        }

        .result-box {
            background: #2ecc71;
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 10px;
            }
            
            .content {
                padding: 20px;
            }
            
            .demo-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .element-pool {
                justify-content: center;
            }

            .group-comparison {
                flex-direction: column;
            }

            .division-visual {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ Interaktivt Bevis for Binomialkoefficienten</h1>
            <p>Komplet trin-for-trin p√¶dagogisk gennemgang</p>
        </div>

        <div class="content">
            <!-- Introduktion -->
            <div class="step-container">
                <div class="step-header">
                    <div class="step-number">üéØ</div>
                    <div class="step-title">Hvad skal vi bevise?</div>
                </div>
                
                    <div class="formula-display">
                        <h3>$$K(n,r) = \frac{n!}{(n-r)! \cdot r!}$$</h3>
                        <p>Antallet af m√•der at v√¶lge r elementer ud af n uden r√¶kkef√∏lge</p>
                    </div>

                <div class="interactive-demo">
                    <h3>üîç Lad os starte med et konkret eksempel</h3>
                    <p>Vi har 5 personer: <strong>A, B, C, D, E</strong></p>
                    <p>Hvor mange forskellige grupper p√• 3 personer kan vi lave?</p>
                    
                    <div class="demo-controls">
                        <div class="control-group">
                            <label>Antal personer (n):</label>
                            <div style="font-size: 1.5em; font-weight: bold; color: #2c3e50;">5</div>
                        </div>
                        <div class="control-group">
                            <label>Gruppest√∏rrelse (r):</label>
                            <div style="font-size: 1.5em; font-weight: bold; color: #2c3e50;">3</div>
                        </div>
                        <button class="btn btn-primary" onclick="startInteractiveProof()">Start Interaktivt Bevis</button>
                    </div>
                </div>
            </div>

            <!-- Trin 1: Med r√¶kkef√∏lge -->
            <div class="step-container" id="step1" style="display: none;">
                <div class="step-header">
                    <div class="step-number">1</div>
                    <div class="step-title">Trin 1: T√¶l MED r√¶kkef√∏lge</div>
                </div>

                <div class="step-explanation">
                    <h4>üí° Id√©en:</h4>
                    <p>F√∏rst t√¶ller vi alle m√•der hvor r√¶kkef√∏lgen BETYDER noget. Det er nemt at regne ud!</p>
                </div>

                <div class="interactive-demo">
                    <h3>üéØ Interaktivt: V√¶lg personer til en r√¶kkef√∏lge</h3>
                    <p>Klik p√• personerne for at placere dem i r√¶kkef√∏lge:</p>
                    
                    <div class="element-pool" id="pool1">
                        <!-- Elementer genereres dynamisk -->
                    </div>

                    <div class="arrangement-area">
                        <h4>Din r√¶kkef√∏lge:</h4>
                        <div id="arrangement1" class="arrangement">
                            <div class="position" id="pos1">1. plads</div>
                            <div class="position" id="pos2">2. plads</div>
                            <div class="position" id="pos3">3. plads</div>
                        </div>
                    </div>

                    <div class="calculation-box">
                        <h4>üìä Beregning:</h4>
                        <div class="calculation-step">
                            <strong>Til 1. plads:</strong> <span id="calc1">5</span> muligheder
                        </div>
                        <div class="calculation-step">
                            <strong>Til 2. plads:</strong> <span id="calc2">4</span> muligheder tilbage
                        </div>
                        <div class="calculation-step">
                            <strong>Til 3. plads:</strong> <span id="calc3">3</span> muligheder tilbage
                        </div>
                        <div class="calculation-step">
                            <strong>I alt:</strong> <span id="totalWithOrder">5 √ó 4 √ó 3 = 60</span> m√•der
                        </div>
                    </div>

                    <button class="btn btn-success" onclick="showAllPermutations()">Vis alle permutationer</button>
                </div>
            </div>

            <!-- Trin 2: Vis alle permutationer -->
            <div class="step-container" id="step2" style="display: none;">
                <div class="step-header">
                    <div class="step-number">2</div>
                    <div class="step-title">Trin 2: Se problemet med r√¶kkef√∏lge</div>
                </div>

                <div class="step-explanation">
                    <h4>üîç Problemet:</h4>
                    <p>Den samme gruppe personer kan st√• i mange forskellige r√¶kkef√∏lger!</p>
                </div>

                <div class="interactive-demo">
                    <h3 id="permutationTitle">üìã Alle r√¶kkef√∏lger for gruppen {A, B, C}:</h3>
                    <p style="text-align: center; color: #666; margin-bottom: 15px;">
                        <em>Scroll ned for at se alle permutationer. ABC gruppen er markeret med s√¶rlig farve.</em>
                    </p>
                    <div class="permutation-grid" id="permutationGrid">
                        <!-- Permutationer genereres dynamisk -->
                    </div>

                    <div class="calculation-box">
                        <h4>üìä Konklusion:</h4>
                        <p id="conclusionText">Der er <span class="highlight">60 permutationer</span> i alt!</p>
                        <p><strong>Men problemet er:</strong> Den samme gruppe personer optr√¶der flere gange!</p>
                        <p>For eksempel er gruppen {A, B, C} blevet talt <span class="highlight">6 gange</span>:</p>
                        <ul style="text-align: left; margin: 15px 0;">
                            <li>ABC, ACB, BAC, BCA, CAB, CBA</li>
                        </ul>
                        <p>Det samme g√¶lder for alle andre grupper p√• 3 personer.</p>
                        <p><strong>Derfor:</strong> Vi skal dividere med antallet af r√¶kkef√∏lger pr. gruppe!</p>
                    </div>

                    <button class="btn btn-warning" onclick="proceedToStep3()">G√• til korrektion</button>
                </div>
            </div>

            <!-- Trin 3: Interaktiv korrektion -->
            <div class="step-container" id="step3" style="display: none;">
                <div class="step-header">
                    <div class="step-number">3</div>
                    <div class="step-title">Trin 3: Interaktiv korrektion af overopt√¶lling</div>
                </div>

                <div class="step-explanation">
                    <h4>‚úÇÔ∏è L√∏sningen:</h4>
                    <p>Vi skal dividere med antallet af r√¶kkef√∏lger pr. gruppe for at f√• det rigtige antal!</p>
                </div>

                <!-- Overopt√¶lling demonstration -->
                <div class="overcounting-demo">
                    <div class="overcounting-title">üö® Problemet: Overopt√¶lling</div>
                    
                    <div class="overcounting-explanation">
                        <h4>Se hvad der sker:</h4>
                        <p>Gruppen {A, B, C} er blevet talt <strong>6 gange</strong> i Trin 1:</p>
                        <ul>
                            <li>ABC, ACB, BAC, BCA, CAB, CBA</li>
                        </ul>
                        <p>Men det er faktisk den <strong>samme gruppe</strong>!</p>
                    </div>

                    <div class="interactive-demo">
                        <h4>üéØ Klik p√• en permutation for at se problemet:</h4>
                        <div class="permutation-grid" id="overcountingGrid">
                            <!-- Genereres dynamisk -->
                        </div>
                        <div id="overcountingExplanation" class="overcounting-explanation" style="display: none;">
                            <p><strong>Se!</strong> Alle disse er den samme gruppe {A, B, C}, men talt som forskellige!</p>
                        </div>
                    </div>
                </div>

                <!-- Korrektion demonstration -->
                <div class="correction-demo">
                    <div class="correction-title">‚úÖ L√∏sningen: Korrektion</div>
                    
                    <div class="interactive-demo">
                        <h4>üßÆ Sammenlign med og uden r√¶kkef√∏lge:</h4>
                        
                        <div class="group-comparison">
                            <div class="group-box with-order">
                                <div class="group-title">Med r√¶kkef√∏lge</div>
                                <div class="group-elements">
                                    <div class="group-element">ABC</div>
                                    <div class="group-element">ACB</div>
                                    <div class="group-element">BAC</div>
                                    <div class="group-element">BCA</div>
                                    <div class="group-element">CAB</div>
                                    <div class="group-element">CBA</div>
                                </div>
                                <p><strong>6 forskellige</strong></p>
                            </div>
                            
                            <div class="arrow">‚Üí</div>
                            
                            <div class="group-box without-order">
                                <div class="group-title">Uden r√¶kkef√∏lge</div>
                                <div class="group-elements">
                                    <div class="group-element without-order">ABC</div>
                                </div>
                                <p><strong>1 gruppe</strong></p>
                            </div>
                        </div>

                        <div class="division-visual">
                            <div class="division-box">
                                <h4>Antal med r√¶kkef√∏lge</h4>
                                <div style="font-size: 2em; font-weight: bold;">60</div>
                            </div>
                            
                            <div class="division-symbol">√∑</div>
                            
                            <div class="division-box">
                                <h4>R√¶kkef√∏lger pr. gruppe</h4>
                                <div style="font-size: 2em; font-weight: bold;">6</div>
                            </div>
                            
                            <div class="arrow">=</div>
                            
                            <div class="result-box">
                                <h4>Antal uden r√¶kkef√∏lge</h4>
                                <div style="font-size: 2em;">10</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="formula-display">
                    <h3>$$K(5,3) = \frac{5!}{3! \cdot (5-3)!} = \frac{120}{6 \cdot 2} = 10$$</h3>
                </div>

                <div class="interactive-exercise">
                    <div class="exercise-question">
                        üéØ Test dig selv: Hvor mange grupper p√• 2 personer kan vi lave ud af 4 personer?
                    </div>
                    <div class="answer-options">
                        <div class="answer-option" onclick="checkAnswer(this, 6)">6</div>
                        <div class="answer-option" onclick="checkAnswer(this, 8)">8</div>
                        <div class="answer-option" onclick="checkAnswer(this, 12)">12</div>
                        <div class="answer-option" onclick="checkAnswer(this, 16)">16</div>
                    </div>
                    <div class="feedback" id="exerciseFeedback" style="display: none;"></div>
                    
                    <button class="btn btn-warning" onclick="showStep(4)" style="margin-top: 20px;">Se matematisk formel</button>
                </div>
            </div>

            <!-- Trin 4: Matematisk formel -->
            <div class="step-container" id="step4" style="display: none;">
                <div class="step-header">
                    <div class="step-number">4</div>
                    <div class="step-title">Trin 4: Den matematiske formel</div>
                </div>

                <div class="step-explanation">
                    <h4>üßÆ Fra konkrete tal til generel formel:</h4>
                    <p>Nu skal vi se hvordan vi kommer fra vores konkrete eksempel til den generelle formel!</p>
                </div>

                <div class="interactive-demo">
                    <h3>üìä Interaktiv matematisk udledning:</h3>
                    <p>Lad os se hvordan vi kommer fra vores konkrete eksempel til den generelle formel!</p>
                    
                    <div class="interactive-demo">
                        <h4>üéØ Trin 1: Antal med r√¶kkef√∏lge</h4>
                        <p>I vores eksempel havde vi n=5 personer og valgte r=3:</p>
                        
                        <div class="element-pool" id="formulaPool1">
                            <!-- Genereres dynamisk -->
                        </div>
                        
                        <div class="calculation-box">
                            <div class="calculation-step">
                                <strong>1. plads:</strong> <span id="formulaCalc1">5</span> muligheder
                            </div>
                            <div class="calculation-step">
                                <strong>2. plads:</strong> <span id="formulaCalc2">4</span> muligheder tilbage
                            </div>
                            <div class="calculation-step">
                                <strong>3. plads:</strong> <span id="formulaCalc3">3</span> muligheder tilbage
                            </div>
                            <div class="calculation-step">
                                <strong>I alt:</strong> <span id="formulaTotal">5 √ó 4 √ó 3 = 60</span> permutationer
                            </div>
                        </div>
                        
                        <div class="step-explanation">
                            <h4>üéØ Test din forst√•else:</h4>
                            <p>Hvad er den generelle formel for antal permutationer af r elementer ud af n?</p>
                            <div class="answer-options">
                                <div class="answer-option" onclick="checkFormulaAnswer(this, 'correct1')">$\frac{n!}{(n-r)!}$</div>
                                <div class="answer-option" onclick="checkFormulaAnswer(this, 'wrong1')">$\frac{n!}{r!}$</div>
                                <div class="answer-option" onclick="checkFormulaAnswer(this, 'wrong1')">$\frac{r!}{(n-r)!}$</div>
                                <div class="answer-option" onclick="checkFormulaAnswer(this, 'wrong1')">$\frac{n!}{n-r}$</div>
                            </div>
                            <div class="feedback" id="formulaFeedback1" style="display: none;"></div>
                        </div>
                    </div>

                    <div class="interactive-demo">
                        <h4>üéØ Trin 2: R√¶kkef√∏lger pr. gruppe</h4>
                        <p>Hvor mange r√¶kkef√∏lger kan gruppen {A, B, C} st√• i?</p>
                        
                        <div class="permutation-grid" id="formulaPermutationGrid">
                            <!-- Genereres dynamisk -->
                        </div>
                        
                        <div class="calculation-box">
                            <div class="calculation-step">
                                <strong>Gruppen {A, B, C} kan st√• i:</strong> <span id="formulaPermutations">3! = 6</span> r√¶kkef√∏lger
                            </div>
                        </div>
                        
                        <div class="step-explanation">
                            <h4>üéØ Test din forst√•else:</h4>
                            <p>Hvor mange r√¶kkef√∏lger kan en gruppe p√• r elementer st√• i?</p>
                            <div class="answer-options">
                                <div class="answer-option" onclick="checkFormulaAnswer(this, 'correct2')">r!</div>
                                <div class="answer-option" onclick="checkFormulaAnswer(this, 'wrong2')">r</div>
                                <div class="answer-option" onclick="checkFormulaAnswer(this, 'wrong2')">r √ó (r-1)</div>
                                <div class="answer-option" onclick="checkFormulaAnswer(this, 'wrong2')">2^r</div>
                            </div>
                            <div class="feedback" id="formulaFeedback2" style="display: none;"></div>
                        </div>
                    </div>

                    <div class="interactive-demo">
                        <h4>üéØ Trin 3: Den endelige formel</h4>
                        <p>Nu kan vi s√¶tte det hele sammen:</p>
                        
                        <div class="division-visual">
                            <div class="division-box">
                                <h4>Antal med r√¶kkef√∏lge</h4>
                                <div style="font-size: 2em; font-weight: bold;">60</div>
                                <p>$\frac{n!}{(n-r)!}$</p>
                            </div>
                            
                            <div class="division-symbol">√∑</div>
                            
                            <div class="division-box">
                                <h4>R√¶kkef√∏lger pr. gruppe</h4>
                                <div style="font-size: 2em; font-weight: bold;">6</div>
                                <p>r!</p>
                            </div>
                            
                            <div class="arrow">=</div>
                            
                            <div class="result-box">
                                <h4>Antal uden r√¶kkef√∏lge</h4>
                                <div style="font-size: 2em;">10</div>
                                <p>$\frac{n!}{(n-r)! \cdot r!}$</p>
                            </div>
                        </div>
                    </div>

                    <div class="formula-display">
                        <h2>$$K(n,r) = \frac{n!}{(n-r)! \cdot r!}$$</h2>
                        <p>Dette er den ber√∏mte binomialkoefficient!</p>
                    </div>

                    <div class="interactive-demo">
                        <h4>üéØ Test formlen med vores eksempel:</h4>
                        <div class="demo-controls">
                            <div class="control-group">
                                <label>n:</label>
                                <input type="number" id="formulaN" value="5" min="2" max="10">
                            </div>
                            <div class="control-group">
                                <label>r:</label>
                                <input type="number" id="formulaR" value="3" min="1" max="5">
                            </div>
                            <button class="btn btn-primary" onclick="testFormula()">Test formlen</button>
                        </div>
                        <div class="calculation-box">
                            <div id="formulaTest"></div>
                        </div>
                    </div>

                    <button class="btn btn-success" onclick="proceedToSummary()">G√• til sammendrag</button>
                </div>
            </div>

            <!-- Sammendrag -->
            <div class="step-container" id="summary" style="display: none;">
                <div class="step-header">
                    <div class="step-number">‚úÖ</div>
                    <div class="step-title">Sammendrag af Beviset</div>
                </div>

                <div class="step-explanation">
                    <h4>üéØ Huskeregel:</h4>
                    <ol style="font-size: 1.3em; line-height: 2;">
                        <li><strong>T√¶l med r√¶kkef√∏lge:</strong> $n \cdot (n-1) \cdot \ldots \cdot (n-r+1) = \frac{n!}{(n-r)!}$</li>
                        <li><strong>Del med r!:</strong> for at fjerne r√¶kkef√∏lgen</li>
                    </ol>
                </div>

                <div class="formula-display">
                    <h2>$$K(n,r) = \frac{n!}{(n-r)! \cdot r!}$$</h2>
                </div>

                <div class="interactive-demo">
                    <h3>üéÆ Pr√∏v selv med forskellige tal:</h3>
                    <div class="demo-controls">
                        <div class="control-group">
                            <label>n:</label>
                            <input type="number" id="finalN" value="6" min="2" max="10">
                        </div>
                        <div class="control-group">
                            <label>r:</label>
                            <input type="number" id="finalR" value="2" min="1" max="5">
                        </div>
                        <button class="btn btn-primary" onclick="calculateFinal()">Beregn</button>
                    </div>
                    <div class="calculation-box">
                        <div id="finalCalculation"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let n = 5;
        let r = 3;
        let elements = ['A', 'B', 'C', 'D', 'E'];
        let selectedElements = [];
        let currentPosition = 0;

        function startInteractiveProof() {
            // Fast v√¶rdier: n=5, r=3
            n = 5;
            r = 3;
            
            // Generer elementer
            elements = [];
            for (let i = 0; i < n; i++) {
                elements.push(String.fromCharCode(65 + i));
            }
            
            // Reset
            selectedElements = [];
            currentPosition = 0;
            
            // Vis kun f√∏rste trin
            showStep(1);
            renderElementPool();
            updateCalculations();
        }

        function showStep(stepNumber) {
            // Vis alle trin op til og med det √∏nskede trin
            for (let i = 1; i <= 4; i++) {
                const element = document.getElementById(`step${i}`);
                if (element) {
                    if (i <= stepNumber) {
                        element.style.display = 'block';
                    } else {
                        element.style.display = 'none';
                    }
                }
            }
            
            // H√•ndter sammendrag separat
            const summaryElement = document.getElementById('summary');
            if (summaryElement) {
                if (stepNumber >= 5) {
                    summaryElement.style.display = 'block';
                    summaryElement.classList.add('fade-in');
                } else {
                    summaryElement.style.display = 'none';
                }
            }
            
            // Generer interaktivt indhold for Trin 4 F√òRST
            if (stepNumber === 4) {
                generateFormulaDemo();
            }
            
            // Scroll til det nye trin
            if (stepNumber <= 4) {
                const targetElement = document.getElementById(`step${stepNumber}`);
                if (targetElement) {
                    setTimeout(() => {
                        targetElement.scrollIntoView({ 
                            behavior: 'smooth', 
                            block: 'start' 
                        });
                    }, 300); // L√¶ngere delay for Trin 4
                }
            } else if (stepNumber >= 5) {
                const summaryElement = document.getElementById('summary');
                if (summaryElement) {
                    setTimeout(() => {
                        summaryElement.scrollIntoView({ 
                            behavior: 'smooth', 
                            block: 'start' 
                        });
                    }, 100);
                }
            }
        }

        function renderElementPool() {
            const pool = document.getElementById('pool1');
            if (!pool) return;
            
            pool.innerHTML = '';
            
            elements.forEach((element, index) => {
                const div = document.createElement('div');
                div.className = 'element';
                div.textContent = element;
                div.id = `element-${element}`;
                
                if (selectedElements.includes(element)) {
                    div.classList.add('used');
                } else {
                    div.onclick = () => selectElement(element);
                }
                
                pool.appendChild(div);
            });
        }

        function selectElement(element) {
            if (currentPosition >= r) return;
            
            selectedElements.push(element);
            currentPosition++;
            
            // Opdater arrangement
            const position = document.getElementById(`pos${currentPosition}`);
            if (position) {
                position.textContent = element;
                position.classList.add('filled');
            }
            
            // Opdater element
            const elementDiv = document.getElementById(`element-${element}`);
            if (elementDiv) {
                elementDiv.classList.add('used');
                elementDiv.onclick = null;
            }
            
            renderElementPool();
            updateCalculations();
        }

        function updateCalculations() {
            const remaining1 = n;
            const remaining2 = n - 1;
            const remaining3 = n - 2;
            
            const calc1 = document.getElementById('calc1');
            const calc2 = document.getElementById('calc2');
            const calc3 = document.getElementById('calc3');
            const totalWithOrder = document.getElementById('totalWithOrder');
            
            if (calc1) calc1.textContent = remaining1;
            if (calc2) calc2.textContent = remaining2;
            if (calc3) calc3.textContent = remaining3;
            
            const total = remaining1 * remaining2 * remaining3;
            if (totalWithOrder) {
                totalWithOrder.textContent = `${remaining1} √ó ${remaining2} √ó ${remaining3} = ${total}`;
            }
        }

        function showAllPermutations() {
            // Generer permutationer f√∏rst
            generatePermutations();
            // Vis Trin 2
            showStep(2);
        }

        function generatePermutations() {
            const grid = document.getElementById('permutationGrid');
            if (!grid) return;
            
            grid.innerHTML = '';
            
            // Generer alle permutationer af 3 elementer ud af n elementer
            const allPermutations = getAllPermutations(elements, r);
            
            console.log('Elements:', elements);
            console.log('r:', r);
            console.log('All permutations:', allPermutations);
            console.log('Number of permutations:', allPermutations.length);
            
            // Opdater titlen
            const title = document.getElementById('permutationTitle');
            if (title) {
                title.textContent = `üìã Alle ${allPermutations.length} permutationer (${r} ud af ${n} med r√¶kkef√∏lge):`;
            }
            
            // Opdater konklusionen
            const conclusion = document.getElementById('conclusionText');
            if (conclusion) {
                conclusion.innerHTML = `Der er <span class="highlight">${allPermutations.length}</span> permutationer i alt!`;
            }
            
            allPermutations.forEach((perm, index) => {
                const div = document.createElement('div');
                div.className = 'permutation-item';
                
                // Marker gruppen {A,B,C} med s√¶rlig farve
                const sortedPerm = [...perm].sort();
                const isABCGroup = sortedPerm.join('') === 'ABC';
                if (isABCGroup) {
                    div.classList.add('highlighted');
                }
                
                const number = document.createElement('div');
                number.style.fontWeight = 'bold';
                number.style.marginBottom = '10px';
                number.textContent = `${index + 1}.`;
                
                const elementsDiv = document.createElement('div');
                elementsDiv.style.display = 'flex';
                elementsDiv.style.gap = '8px';
                elementsDiv.style.justifyContent = 'center';
                
                perm.forEach(element => {
                    const el = document.createElement('div');
                    el.className = 'element';
                    el.style.padding = '8px 12px';
                    el.style.fontSize = '1em';
                    el.textContent = element;
                    elementsDiv.appendChild(el);
                });
                
                div.appendChild(number);
                div.appendChild(elementsDiv);
                grid.appendChild(div);
            });
        }

        function generateOvercountingDemo() {
            const grid = document.getElementById('overcountingGrid');
            if (!grid) return;
            
            grid.innerHTML = '';
            
            // Generer kun permutationer af ABC gruppen
            const group = ['A', 'B', 'C'];
            const permutations = getPermutations(group);
            
            permutations.forEach((perm, index) => {
                const div = document.createElement('div');
                div.className = 'permutation-item';
                div.onclick = () => highlightOvercounting(div);
                
                const elementsDiv = document.createElement('div');
                elementsDiv.style.display = 'flex';
                elementsDiv.style.gap = '8px';
                elementsDiv.style.justifyContent = 'center';
                
                perm.forEach(element => {
                    const el = document.createElement('div');
                    el.className = 'element';
                    el.style.padding = '8px 12px';
                    el.style.fontSize = '1em';
                    el.textContent = element;
                    elementsDiv.appendChild(el);
                });
                
                div.appendChild(elementsDiv);
                grid.appendChild(div);
            });
        }

        function highlightOvercounting(element) {
            // Fjern tidligere highlights
            document.querySelectorAll('.permutation-item').forEach(item => {
                item.classList.remove('highlighted');
            });
            
            // Highlight denne permutation
            element.classList.add('highlighted');
            
            // Vis forklaring
            const explanation = document.getElementById('overcountingExplanation');
            if (explanation) {
                explanation.style.display = 'block';
            }
        }

        function proceedToStep3() {
            // Generer overopt√¶lling demo f√∏rst
            generateOvercountingDemo();
            // Vis Trin 3
            showStep(3);
        }

        function proceedToSummary() {
            showStep(5);
        }

        function generateFormulaDemo() {
            // Generer elementer til Trin 1
            const pool = document.getElementById('formulaPool1');
            if (pool) {
                pool.innerHTML = '';
                elements.forEach((element, index) => {
                    const div = document.createElement('div');
                    div.className = 'element';
                    div.textContent = element;
                    pool.appendChild(div);
                });
            }
            
            // Opdater beregninger
            const calc1 = document.getElementById('formulaCalc1');
            const calc2 = document.getElementById('formulaCalc2');
            const calc3 = document.getElementById('formulaCalc3');
            const total = document.getElementById('formulaTotal');
            
            if (calc1) calc1.textContent = n;
            if (calc2) calc2.textContent = n - 1;
            if (calc3) calc3.textContent = n - 2;
            if (total) total.textContent = `${n} √ó ${n-1} √ó ${n-2} = ${n * (n-1) * (n-2)}`;
            
            // Generer permutationer til Trin 2
            const grid = document.getElementById('formulaPermutationGrid');
            if (grid) {
                grid.innerHTML = '';
                const group = ['A', 'B', 'C'];
                const permutations = getPermutations(group);
                
                permutations.forEach((perm, index) => {
                    const div = document.createElement('div');
                    div.className = 'permutation-item';
                    
                    const elementsDiv = document.createElement('div');
                    elementsDiv.style.display = 'flex';
                    elementsDiv.style.gap = '8px';
                    elementsDiv.style.justifyContent = 'center';
                    
                    perm.forEach(element => {
                        const el = document.createElement('div');
                        el.className = 'element';
                        el.style.padding = '8px 12px';
                        el.style.fontSize = '1em';
                        el.textContent = element;
                        elementsDiv.appendChild(el);
                    });
                    
                    div.appendChild(elementsDiv);
                    grid.appendChild(div);
                });
            }
            
            // Opdater permutation antal
            const permCount = document.getElementById('formulaPermutations');
            if (permCount) {
                permCount.textContent = `${r}! = ${factorial(r)}`;
            }
        }

        function checkFormulaAnswer(element, answerType) {
            // Fjern tidligere valg
            const parent = element.parentElement;
            parent.querySelectorAll('.answer-option').forEach(opt => {
                opt.classList.remove('correct', 'incorrect');
            });
            
            const feedbackId = answerType.includes('1') ? 'formulaFeedback1' : 'formulaFeedback2';
            const feedback = document.getElementById(feedbackId);
            
            if (answerType === 'correct1') {
                element.classList.add('correct');
                feedback.textContent = 'üéâ Korrekt! Antal permutationer af r ud af n er n!/(n-r)!';
                feedback.className = 'feedback correct';
            } else if (answerType === 'correct2') {
                element.classList.add('correct');
                feedback.textContent = 'üéâ Korrekt! En gruppe p√• r elementer kan st√• i r! r√¶kkef√∏lger';
                feedback.className = 'feedback correct';
            } else {
                element.classList.add('incorrect');
                if (answerType === 'wrong1') {
                    feedback.textContent = '‚ùå Forkert. Den rigtige formel er n!/(n-r)!';
                } else {
                    feedback.textContent = '‚ùå Forkert. Den rigtige formel er r!';
                }
                feedback.className = 'feedback incorrect';
            }
            
            feedback.style.display = 'block';
        }

        function testFormula() {
            const formulaN = document.getElementById('formulaN');
            const formulaR = document.getElementById('formulaR');
            
            if (!formulaN || !formulaR) return;
            
            const n = parseInt(formulaN.value);
            const r = parseInt(formulaR.value);
            
            if (r > n) {
                const testDiv = document.getElementById('formulaTest');
                if (testDiv) {
                    testDiv.innerHTML = '<p style="color: red;">r kan ikke v√¶re st√∏rre end n!</p>';
                }
                return;
            }
            
            const result = factorial(n) / (factorial(r) * factorial(n - r));
            
            const testDiv = document.getElementById('formulaTest');
            if (testDiv) {
                testDiv.innerHTML = `
                    <h4>Test af formlen:</h4>
                    <p><strong>K(${n},${r}) = ${n}!/(${r}!¬∑${n-r}!)</strong></p>
                    <p>= ${factorial(n)}/(${factorial(r)}¬∑${factorial(n-r)})</p>
                    <p>= ${result}</p>
                    <p style="color: #27ae60; font-weight: bold;">‚úì Formlen virker!</p>
                `;
            }
        }

        function getPermutations(arr) {
            if (arr.length <= 1) return [arr];
            
            const result = [];
            for (let i = 0; i < arr.length; i++) {
                const current = arr[i];
                const remaining = arr.slice(0, i).concat(arr.slice(i + 1));
                const perms = getPermutations(remaining);
                
                perms.forEach(perm => {
                    result.push([current, ...perm]);
                });
            }
            
            return result;
        }

        function getAllPermutations(elements, r) {
            if (r === 0) return [[]];
            if (r === 1) return elements.map(el => [el]);
            
            const result = [];
            
            for (let i = 0; i < elements.length; i++) {
                const current = elements[i];
                const remaining = elements.slice(0, i).concat(elements.slice(i + 1));
                const perms = getAllPermutations(remaining, r - 1);
                
                perms.forEach(perm => {
                    result.push([current, ...perm]);
                });
            }
            
            return result;
        }

        function checkAnswer(element, correctAnswer) {
            const n = 4;
            const r = 2;
            const correct = factorial(n) / (factorial(r) * factorial(n - r));
            
            // Fjern tidligere valg
            document.querySelectorAll('.answer-option').forEach(opt => {
                opt.classList.remove('correct', 'incorrect');
            });
            
            const feedback = document.getElementById('exerciseFeedback');
            if (!feedback) return;
            
            if (correctAnswer === correct) {
                element.classList.add('correct');
                feedback.textContent = 'üéâ Korrekt! K(4,2) = 4!/(2!¬∑2!) = 24/(2¬∑2) = 6';
                feedback.className = 'feedback correct';
            } else {
                element.classList.add('incorrect');
                feedback.textContent = `‚ùå Forkert. Det rigtige svar er ${correct}. K(4,2) = 4!/(2!¬∑2!) = 24/(2¬∑2) = 6`;
                feedback.className = 'feedback incorrect';
            }
            
            feedback.style.display = 'block';
        }

        function showFinalSummary() {
            showStep(5);
        }

        function calculateFinal() {
            const finalN = document.getElementById('finalN');
            const finalR = document.getElementById('finalR');
            
            if (!finalN || !finalR) return;
            
            const n = parseInt(finalN.value);
            const r = parseInt(finalR.value);
            
            const result = factorial(n) / (factorial(r) * factorial(n - r));
            
            const calculation = document.getElementById('finalCalculation');
            if (calculation) {
                calculation.innerHTML = `
                    <h4>K(${n},${r}) = ${n}!/(${r}!¬∑${n-r}!)</h4>
                    <p>= ${factorial(n)}/(${factorial(r)}¬∑${factorial(n-r)})</p>
                    <p>= ${result}</p>
                `;
            }
        }

        function factorial(n) {
            if (n <= 1) return 1;
            return n * factorial(n - 1);
        }

        // Initialiser
        document.addEventListener('DOMContentLoaded', function() {
            // Ingen initialisering n√∏dvendig - alt vises n√•r man klikker "Start"
        });
    </script>
</body>
</html>